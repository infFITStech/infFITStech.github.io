import{j as A,l as v,m as K,o as i,c as Q,w as U,_ as W,b_ as w,d as e,g as n,s as g,n as r,t as m,F as _,T as S,h as x,e as B,$,O as X,P as Y}from"./index-be38bd07.js";import"./bootstrap.min-75e5318b.js";const c=f=>(X("data-v-986c3509"),f=f(),Y(),f),Z={class:"container-fluid py-3"},O=c(()=>e("div",{class:"row mb-3"},[e("h1",{class:"col-12"},"產品管理")],-1)),G={class:"col-12"},ee={class:"h-100 flex-grow-1 bg-white rounded container-fluid"},te={class:"row d-flex align-items-center py-3"},se={class:"col-2 col-md-1 flex-grow-0 mb-4 mb-md-0"},oe={class:"profile-img"},le={class:"img-circle-wrapper"},ie=["src"],ne={class:"col-8 col-md-2 text-body font-bold mb-4 mb-md-0"},ae={class:"d-block d-md-none col-2 text-right"},de=["onClick"],ce=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),re=[ce],me={class:"col-12 px-md-0 col-md flex-shrink-0 flex-grow-1 d-flex flex-column flex-md-row align-items-stretch"},he={class:"dropdown mr-md-2 mr-lg-3 mb-1 mb-md-0"},ge={class:"w-100 btn btn-primary rounded-pill dropdown-toggle",type:"button","data-toggle":"dropdown","aria-expanded":"false"},_e={class:"dropdown-menu"},pe=c(()=>e("div",{class:"dropdown-item",disabled:""}," 選擇欲顯示的詢問動線 ",-1)),ue=["onClick"],ve={class:"dropdown mr-md-2 mb-1 mb-md-0"},we=c(()=>e("button",{class:"w-100 btn btn-primary rounded-pill dropdown-toggle",type:"button","data-toggle":"dropdown","aria-expanded":"false"},m("新增標籤"),-1)),xe=["id"],fe={class:"text-right"},ye=["onClick"],be=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),ke=[be],Te={class:"text-gray ml-2 mb-2"},Ce={class:"container-fluid"},Me={class:"row"},Be=["onClick"],ze={key:0,class:"position-absolute left-0",style:{top:"50%",transform:"translate(50%, -50%)"}},Pe=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("g",{fill:"none"},[e("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e("path",{fill:"currentColor",d:"M11 20a1 1 0 1 0 2 0v-7h7a1 1 0 1 0 0-2h-7V4a1 1 0 1 0-2 0v7H4a1 1 0 1 0 0 2h7z"})])],-1)),Ie=[Pe],Ne={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},Se={class:"profile-img mr-1",style:{border:"none",width:"20px","min-width":"20px"}},$e={class:"img-circle-wrapper"},Ve=["src"],Re={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},He=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Le=[He],Je={class:"container-fluid px-2 mr-md-2"},Fe={class:"row"},De=["onClick"];const Ee={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},je={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},qe={class:"img-circle-wrapper"},Ae=["src"],Ke={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},Qe=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Ue=[Qe],We=["id"],Xe=["onClick"];const Ye={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},Ze={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},Oe={class:"img-circle-wrapper"},Ge=["src"],et={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},tt=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),st=[tt],ot={key:0,class:"flex-shrink-0"},lt=["data-target","aria-controls"],it=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M14 10.25a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.249 1.249 0 1 1 2.5 0a1.25 1.25 0 1 1-2.5 0"})],-1)),nt=[it],at={class:"d-none d-md-block col-auto text-right"},dt=["onClick"],ct=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),rt=[ct],mt={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},ht={class:"modal-dialog modal-dialog-centered",role:"document"},gt={class:"modal-content"},_t=c(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),pt=c(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此產品？")],-1)),ut={class:"modal-footer border-0"},vt=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),wt={__name:"ProductView",setup(f){const V=v([]),y=v([]),z=v([]),P=v([]),I=v({Route:"",Tags:{}}),R=async()=>{const t=await w.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1"),l={};t.data.models.forEach(s=>{l[s.TagGroup]||(l[s.TagGroup]=[]),l[s.TagGroup].push(s)}),y.value=[],y.value=Object.keys(l).map(s=>({group:s,tags:l[s]}))},H=async()=>{const t=await w.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_routes?Brand=INFS&Per_Page=100&Page=1");z.value=[...t.data.models]},b=async()=>{const t=await w.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_products?Brand=INFS&Per_Page=100&Page=1");V.value=t.data.models,P.value=[...t.data.models]},k=(t={id:String(new Date().getTime()),Tags:{},Routes:[]},l=!0,s="editModal")=>{I.value=Object.assign({id:String(new Date().getTime()),Tags:{},Routes:[]},JSON.parse(JSON.stringify(t))),l&&L(s)},L=t=>{$(`#${t}`).modal("toggle")},J=t=>(t==null?void 0:t[0].Name)||null,T=(t,l,s)=>t.Tags[l]&&t.Tags[l].some(a=>a.Tag===s.Tag),N=(t,l,s)=>{const a=t.Tags[l].findIndex(o=>o.Tag===s.Tag);a!==-1&&(t.Tags[l].splice(a,1),M({Routes:t.Routes,Tags:t.Tags,id:t.id}))},F=t=>{$(t).dropdown("hide")},D=(t,l)=>{t.Routes=[l],M({Routes:t.Routes,Tags:t.Tags,id:t.id})},E=(t,l,s)=>{t.Tags[l]||(t.Tags[l]=[]);const a=t.Tags[l].findIndex(o=>o.Tag===s.Tag);a===-1?t.Tags[l].push(s):t.Tags[l].splice(a,1),M({Product:t.Product,Tags:t.Tags,id:t.id})},C=t=>{const l=[];for(const s in t.Tags)t.Tags[s].forEach(a=>{l.push({tag:a,group:s})});return JSON.parse(JSON.stringify(l))},M=async t=>{const l={Brand:"INFS",...t},s=await w.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_product",l);console.log(s),b()},j=async()=>{const t=await w.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_product?Brand=INFS&id=${I.value.id}`);console.log(t),b(),k({},!0,"deleteModal")};return K(()=>{R(),H(),b()}),(t,l)=>(i(),Q(W,null,{default:U(()=>[e("div",Z,[O,(i(!0),n(_,null,g(P.value,(s,a)=>(i(),n("div",{key:a,class:"row mb-3"},[e("div",G,[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("div",le,[e("div",{class:r(["img-circle img-fluid bg-gray-light",s.Imgsrc?"":"d-none"])},null,2),e("img",{class:r(["img-circle img-fluid",s.Imgsrc?"":"d-none"]),src:s.Imgsrc,alt:""},null,10,ie)])])]),e("div",ne,m(s.ItemName),1),e("div",ae,[e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer mr-4",onClick:o=>k(s,!0,"deleteModal")},re,8,de)]),e("div",me,[e("div",he,[e("button",ge,m(J(s.Routes)||"選擇動線"),1),e("div",_e,[pe,(i(!0),n(_,null,g(z.value,(o,d)=>(i(),n("div",{key:o.Route,class:"dropdown-item",onClick:h=>D(s,o)},m(o.Name)+" ("+m(o.TagGroups_order.join(" - "))+") ",9,ue))),128))])]),e("div",ve,[we,e("div",{id:`tagDropdownMenu${a}`,class:"dropdown-menu p-2",style:{"min-width":"400px"},onclick:"event.stopPropagation()"},[e("div",fe,[e("button",{type:"button",class:"btn btn-sm rounded-circle",onClick:S(o=>F(`#tagDropdownMenu${a}`),["stop"])},ke,8,ye)]),(i(!0),n(_,null,g(y.value,o=>(i(),n("div",{key:o,class:"d-flex flex-column mb-2"},[e("div",Te,m(o.group||"新增標籤"),1),e("div",Ce,[e("div",Me,[(i(!0),n(_,null,g(o.tags,d=>(i(),n("div",{key:d,class:"col-4 p-0 px-1 mb-2"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative",T(s,o.group,d)?"bg-secondary text-white":"bg-white text-secondary"]),onClick:S(h=>E(s,o.group,d),["stop"]),style:{"line-height":"1"}},[T(s,o.group,d)?x("",!0):(i(),n("div",ze,Ie)),e("div",Ne,[e("div",Se,[e("div",$e,[e("div",{class:r(["img-circle img-fluid",d.Imgsrc?"":"d-none"])},null,2),e("img",{class:r(["img-circle img-fluid",d.Imgsrc?"":"d-none"]),src:d.Imgsrc,alt:""},null,10,Ve)])]),B(" "+m(d.Name),1)]),T(s,o.group,d)?(i(),n("div",Re,Le)):x("",!0)],10,Be)]))),128))])])]))),128))],8,xe)]),e("div",Je,[e("div",Fe,[(i(!0),n(_,null,g(JSON.parse(JSON.stringify(C(s))).slice(0,4),o=>{var d,h,p,u;return i(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-0"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative","bg-secondary text-white"]),onClick:q=>N(s,o.tag.TagGroup,o.tag)},[x("",!0),e("div",Ee,[e("div",je,[e("div",qe,[e("div",{class:r(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:r(["img-circle img-fluid",(h=o.tag)!=null&&h.Imgsrc?"":"d-none"]),src:(p=o.tag)==null?void 0:p.Imgsrc,alt:""},null,10,Ae)])]),B(" "+m((u=o.tag)==null?void 0:u.Name),1)]),(i(),n("div",Ke,Ue))],8,De)])}),128))]),e("div",{class:"collapse row",id:`collapseTag${a}`},[(i(!0),n(_,null,g(JSON.parse(JSON.stringify(C(s))).slice(4),o=>{var d,h,p,u;return i(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-0"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative","bg-secondary text-white"]),onClick:q=>N(s,o.tag.TagGroup,o.tag)},[x("",!0),e("div",Ye,[e("div",Ze,[e("div",Oe,[e("div",{class:r(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:r(["img-circle img-fluid",(h=o.tag)!=null&&h.Imgsrc?"":"d-none"]),src:(p=o.tag)==null?void 0:p.Imgsrc,alt:""},null,10,Ge)])]),B(" "+m((u=o.tag)==null?void 0:u.Name),1)]),(i(),n("div",et,st))],8,Xe)])}),128))],8,We)]),C(s).length>4?(i(),n("div",ot,[e("button",{class:"btn h4 mb-0 p-0 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button","data-toggle":"collapse","data-target":`#collapseTag${a}`,"aria-expanded":"false","aria-controls":`collapseTag${a}`,style:{width:"2rem",height:"2rem"}},nt,8,lt)])):x("",!0)]),e("div",at,[e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer",onClick:o=>k(s,!0,"deleteModal")},rt,8,dt)])])])])]))),128)),e("div",mt,[e("div",ht,[e("div",gt,[_t,pt,e("div",ut,[vt,e("button",{type:"button",class:"btn btn-primary",onClick:l[0]||(l[0]=s=>j())},"刪除")])])])])])]),_:1}))}},yt=A(wt,[["__scopeId","data-v-986c3509"]]);export{yt as default};

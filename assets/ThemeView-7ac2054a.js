import{j as N,l as v,m as G,o as n,c as B,w as z,_ as S,b_ as h,d as e,g as c,s as w,t as u,F as x,n as y,q as b,x as f,$,O as j,P as E}from"./index-be38bd07.js";import"./bootstrap.min-75e5318b.js";const l=r=>(j("data-v-45eb81b5"),r=r(),E(),r),L={class:"container py-3"},V=l(()=>e("div",{class:"row mb-3"},[e("h1",{class:"col-12"},"主題標籤管理")],-1)),A={class:"col-12 font-bold mb-2"},F={class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},O=["onClick"],U=l(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",null,[e("div",{class:"profile-img w-100 border-4 mb-3"},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW")])],-1)),P=[U],J={class:"h-100 card text-center border-0 rounded bg-white shadow"},R={class:"card-header py-4"},W={class:"profile-img mb-3"},q={class:"img-circle-wrapper"},H=["src"],K={class:"h4 font-bold text-body mb-1"},Q={class:"text-break text-truncate"},X={class:"position-absolute top-0 right-0 dropdown p-3"},Y=l(()=>e("div",{class:"cursor-pointer",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},[e("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"})])],-1)),Z={class:"dropdown-menu dropdown-menu-right","aria-labelledby":"dropdownMenuButton"},ee=["onClick"],te=["onClick"],se={class:"row"},oe={class:"col-12 mb-3"},ae=l(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"d-flex align-items-center"},[e("div",{class:"profile-img border-4 mr-2",style:{width:"40px"}},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW THEME")])],-1)),le=[ae],ie={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},ne={class:"modal-dialog modal-dialog-centered",role:"document"},de={class:"modal-content"},ce=l(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),re=l(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此標籤？")],-1)),me={class:"modal-footer border-0"},pe=l(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),he={class:"modal fade",id:"editModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},ue={class:"modal-dialog modal-dialog-centered",role:"document"},_e={class:"modal-content"},ge={class:"modal-header border-0"},ve={class:"modal-title"},be=l(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1)),fe={class:"modal-body"},we={id:"form-edit",class:"d-flex align-items-start"},xe={class:"d-block w-25"},ye={class:"d-flex flex-column w-75 mx-auto cursor-pointer"},Te={class:"img-circle-wrapper mb-2"},ke=["src"],Ie={key:1,class:"img-circle img-fluid bg-gray-light"},Ce={class:"w-75 container-fluid"},Me={class:"d-flex align-items-center mb-2"},De=l(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),Ne={class:"d-flex align-items-center mb-2"},Ge=l(()=>e("label",{class:"pr-2 flex-shrink-0"},"名稱",-1)),Be={class:"d-flex align-items-center mb-2"},ze=l(()=>e("label",{class:"pr-2 flex-shrink-0"},"描述",-1)),Se={class:"modal-footer flex-column align-items-end border-0"},$e=l(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),je=l(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),Ee={__name:"ThemeView",setup(r){const T=v([]),_=v([]),o=v({}),k=a=>{const t=a.target.files[0];if(!t)return;const s=new Image;s.src=URL.createObjectURL(t),s.onload=()=>{if(s.width/s.height!==3/4){alert("圖片比例不符合3:4");return}else h.put(`https://x24sw7agoh.execute-api.ap-northeast-2.amazonaws.com/v2/inffitsmanager.assets/tmp/tmp/${t.name}`,t,{headers:{"Content-Type":t.type}}).then(m=>{const p="https://s3.ap-northeast-2.amazonaws.com/inffitsmanager.assets/tmp/tmp/"+t.name;console.log(p),o.value.Imgsrc=p}).catch(m=>{console.error(m),console.log("IMG UPLOAD FAIL")})}},g=()=>{h.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1").then(a=>{const t={};T.value=a.data.models,a.data.models.forEach(s=>{t[s.TagGroup]||(t[s.TagGroup]=[]),t[s.TagGroup].push(s)}),_.value=[];for(const s in t)_.value.push({group:s,tags:t[s]})})},d=(a={TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},t=!0,s="editModal")=>{o.value=Object.assign({TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},JSON.parse(JSON.stringify(a))),t&&I(s)},I=a=>{$(`#${a}`).modal("toggle")},C=()=>{h.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_tag",{Brand:"INFS",Data:o.value}).then(a=>{console.log(a),g(),d({},!0,"editModal")})},M=()=>{h.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_tag?Brand=INFS&Tag=${o.value.Tag}`).then(a=>{console.log(a),g(),d({},!0,"deleteModal")})};return G(()=>{g()}),(a,t)=>(n(),B(S,null,{default:z(()=>[e("div",L,[V,(n(!0),c(x,null,w(_.value,(s,m)=>(n(),c("div",{key:m,class:"row mb-3"},[e("h4",A,u(s.group),1),e("div",F,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:i=>d({TagGroup:s.group})},P,8,O)]),(n(!0),c(x,null,w(s.tags,(i,p)=>(n(),c("div",{key:p,class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},[e("div",J,[e("div",R,[e("div",W,[e("div",q,[e("div",{class:y(["img-circle img-fluid bg-gray-light",i.Imgsrc?"":"d-none"])},null,2),e("img",{class:y(["img-circle img-fluid",i.Imgsrc?"":"d-none"]),src:i.Imgsrc,alt:""},null,10,H)])]),e("div",K,u(i.Name),1),e("small",Q,u(i.Description),1),e("div",X,[Y,e("div",Z,[e("a",{class:"dropdown-item",onClick:D=>d(i,!0,"editModal")},"Edit",8,ee),e("a",{class:"dropdown-item",onClick:D=>d(i,!0,"deleteModal")},"Delete",8,te)])])])])]))),128))]))),128)),e("div",se,[e("div",oe,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:t[0]||(t[0]=s=>d())},le)])])]),e("div",ie,[e("div",ne,[e("div",de,[ce,re,e("div",me,[pe,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=s=>M())},"刪除")])])])]),e("div",he,[e("div",ue,[e("div",_e,[e("div",ge,[e("h5",ve,u(o.value.Key?"編輯":"新增")+"標籤",1),be]),e("div",fe,[e("form",we,[e("label",xe,[e("label",ye,[e("div",Te,[o.value.Imgsrc?(n(),c("img",{key:0,class:"img-circle img-fluid",id:"img-edit",src:o.value.Imgsrc,alt:""},null,8,ke)):(n(),c("div",Ie))]),e("input",{type:"file",class:"d-none",onChange:k,accept:"image/*"},null,32)])]),e("div",Ce,[e("div",Me,[De,b(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.TagGroup=s),class:"form-control"},null,512),[[f,o.value.TagGroup]])]),e("div",Ne,[Ge,b(e("input",{type:"text",name:"Name","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.Name=s),class:"form-control"},null,512),[[f,o.value.Name]])]),e("div",Be,[ze,b(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[4]||(t[4]=s=>o.value.Description=s),class:"form-control"},null,512),[[f,o.value.Description]])])])])]),e("div",Se,[$e,e("div",null,[je,e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=s=>C())},"存檔")])])])])])]),_:1}))}},Ae=N(Ee,[["__scopeId","data-v-45eb81b5"]]);export{Ae as default};
